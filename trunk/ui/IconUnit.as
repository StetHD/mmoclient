package ui{	import flash.display.MovieClip;	import flash.display.Bitmap;	import flash.display.BitmapData;			import flash.events.MouseEvent;		import game.Game;	import game.unit.Unit;	import game.unit.events.UnitEvent;	import game.entity.Army;	import flash.utils.setTimeout;	import flash.utils.clearTimeout;	import flash.utils.Timer;	import flash.events.TimerEvent;			public class IconUnit extends MovieClip 	{		private static var REST:int = 0;		private static var ACTIVATE:int = 1;		private static var DOUBLE_CLICK_SPEED:int = 1000;				public var stackSize:MovieClip;		public var imageLayer:MovieClip;				public var unit:Unit;		public var anchorX:int;		public var anchorY:int;						public var dragging:Boolean = false;				protected var image:Bitmap = null;				private var mouseTimeout;		private var timer:Timer;				public function IconUnit()		{	 			timer = new Timer(300, 1);            timer.addEventListener(TimerEvent.TIMER, timerComplete);						doubleClickEnabled = true;			stackSize.doubleClickEnabled = true;			imageLayer.doubleClickEnabled = true;						//addEventListener(MouseEvent.CLICK, mouseClick);			addEventListener(MouseEvent.DOUBLE_CLICK, mouseDoubleClick);			//addEventListener(MouseEvent.MOUSE_DOWN, mouseDown);			//addEventListener(MouseEvent.MOUSE_UP, mouseUp);		}						public function setUnit(unit:Unit) : void		{			this.unit = unit						var iconBitmapData:BitmapData = Unit.getImage(unit.type);						image = new Bitmap(iconBitmapData);			image.x = 0;			image.y = 0;						imageLayer.addChild(image);								updateStackSize();		}				public function updateStackSize() : void		{			stackSize.sizeText.text = UtilUI.FormatNum(unit.size);		}						private function mouseClick(e:MouseEvent) : void		{			trace("Mouse Click"); 			timer.reset();            timer.start();							}				private function timerComplete(e:TimerEvent) : void		{			trace("Timer Complete");		}				private function mouseDown(e:MouseEvent) : void		{			trace("Mouse Down");		}						private function mouseUp(e:MouseEvent) : void		{			trace("Mouse Up");		}				/*private function mouseClick(e:MouseEvent) : void		{			trace("MouseClick: " + mouseTimeout);						if (mouseTimeout != undefined) 			{				doubleClick();				clearTimeout(mouseTimeout);				mouseTimeout = undefined;			} 			else 			{				mouseTimeout = setTimeout(handleSingleClick, DOUBLE_CLICK_SPEED);				trace("mouseTimeout: " + mouseTimeout);			}		}				private function handleSingleClick() : void 		{			singleClick();			mouseTimeout = undefined;		}				private function singleClick() : void		{			trace("IconUnit MouseDown Click");			var mouseDownEvent:ParamEvent = new ParamEvent("MouseDown");			mouseDownEvent.params = this;						dispatchEvent(mouseDownEvent);		}*/				private function mouseDoubleClick(e:MouseEvent) : void		{			trace("IconUnit DoubleClick");			Game.INSTANCE.main.unitDetail.setUnit(unit);			Game.INSTANCE.main.unitDetail.showPanel();		}			}	}